{% extends "base.html" %}
{% block main %}

    <!----- main ----->
    <div style="text-align: center;">
        <button id="start_btn" name = "start_button">Start</button>
        <button id="stop_btn">Stop</button>
    </div>
    <div style="text-align: center;">
        <video id="video_area" style="background-color: #000" autoplay></video> 
    </div>
    <!----- /main ----->

 <script>

    if (typeof navigator.mediaDevices.getUserMedia !== 'function') {
        const err = new Error('getUserMedia()が使えないブラウザだよ');
        alert(`${err.name} ${err.message}`);
        throw err;
    }

    const $start = document.getElementById('start_btn');   // スタートボタン
    const $video = document.getElementById('video_area');  // 映像表示エリア
    const $stop = document.getElementById('stop_btn');   // ストップボタン

    $start.addEventListener('click', () => {
        navigator.mediaDevices.getUserMedia({ video: true, audio: false })
        .then(stream => $video.srcObject = stream)
        .catch(err => alert(`${err.name} ${err.message}`));
    }, false);

    $stop.addEventListener('click', () => {
        const tracks = document.getElementById('video_area').srcObject.getTracks();
        tracks.forEach(track => {
        track.stop();
        });

        document.getElementById('video_area').srcObject = null;
    }, false);

</script>
{% endblock %}